<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>


<article-meta>


<title-group>
<article-title>San Pedro Flood-MAR</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0009-0006-0181-3099</contrib-id>
<name>
<surname>Zalesky</surname>
<given-names>Travis</given-names>
</name>
<string-name>Travis Zalesky</string-name>

<email>travisz@arizona.edu</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>University of Arizona</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">travisz@arizona.edu</corresp>
</author-notes>









<history></history>


<abstract>
<p>Continuation of ATUR
<ext-link ext-link-type="uri" xlink:href="https://travisz09.github.io/ATUR-Broad-Suitability-Analysis/">Broad
Suitability Analysis</ext-link> with emphasis on San Pedro watershed. By
narrowing the focus of this analysis I hope to achieve additional
progress that will help to inform the broader analysis downstream.
Methods and analysis closely following Aloui et al.
(<xref alt="2024" rid="ref-aloui2024" ref-type="bibr">2024</xref>)</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Arizona Tri University Recharge (ATUR)</kwd>
<kwd>San Pedro Watershed</kwd>
<kwd>Managed Aquifer Recharge</kwd>
<kwd>Suitability Analysis</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1 Introduction</title>
  <p>Please see
  <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S2352801X24000602#bib49">Identifying
  suitable zones for integrated aquifer recharge and flood control in
  arid Qatar using GIS-based multi-criteria decision-making</ext-link>
  (<xref alt="Aloui et al., 2024" rid="ref-aloui2024" ref-type="bibr">Aloui
  et al., 2024</xref>)</p>
  <sec id="study-area">
    <title>1.1 Study Area</title>
    <fig id="fig-studyArea">
      <caption><p>Figure 1: San Pedro watershed, study
      area.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="images/SanPedro_Reference_Painted.png" />
    </fig>
  </sec>
</sec>
<sec id="sec-data-methods">
  <title>2 Data &amp; Methods</title>
  <sec id="thematic-layers">
    <title>2.1 Thematic Layers</title>
    <p>All data layers were processed in ArcGIS Pro v3.4.0 unless
    otherwise indicated. Data layers were converted into raster data as
    needed, with a 30m resolution, matching the SRTM elevation raster
    (see
    <xref alt="Section 2.1.1" rid="sec-elev">Section 2.1.1</xref>).</p>
    <sec id="sec-elev">
      <title>2.1.1 Elevation</title>
      <p>Higher elevations are at lower flood risk due to naturally
      occurring drainage, frequently in the form of surface runoff.
      While lower elevations have higher surface water flow accumulation
      (<bold>CITATION NEEDED</bold>) which can promote infiltration
      (<bold>CITATION NEEDED</bold>).</p>
      <p>Elevation data acquired from NASA Shuttle Radar Topography
      Mission (SRTM) 30m resolution global Digital Elevation Model
      (DEM), accessed via Google Earth Engine (GEE) (<bold>DATA
      CITATION</bold>).</p>
      <fig id="fig-elev">
        <caption><p>Figure 2: San Pedro elevation 30m NASA
        SRTM.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/SanPedro_Elev.png" />
      </fig>
    </sec>
    <sec id="slope">
      <title>2.1.2 Slope</title>
      <p>Steeper slopes tend to promote surface flow and high erosion.
      Gentler slopes however have decreased surface water flow rates,
      increasing residence time, and potentially resulting in flooding
      during times of heavy rainfall or snowmelt (<bold>CITATION
      NEEDED</bold>).</p>
      <p>Slope data was calculated as a first order derivative of the
      elevation data.</p>
      <fig id="fig-slope">
        <caption><p>Figure 3: San Pedro slope.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/SanPedro_Slope.png" />
      </fig>
    </sec>
    <sec id="lineament-density">
      <title>2.1.3 Lineament Density</title>
      <p>Lineaments such as faults and fractures fundamentally influence
      water flow dynamics.</p>
      <p><bold>This layer is not yet available, but I believe that Ryan
      is working on this concept</bold></p>
      <p>See Aloui et al.
      (<xref alt="2024" rid="ref-aloui2024" ref-type="bibr">2024</xref>)
      section 3.1.3 Lineament density (LD) for additional methods on
      generating lineament features from a DEM.</p>
    </sec>
    <sec id="drainage-density">
      <title>2.1.4 Drainage Density</title>
      <p>High drainage density increases flood susceptibility via rapid
      water accumulation through channels (<bold>CITATION
      NEEDED</bold>). Additionally, the increased flow rate in areas
      with high drainage density reduces the residence time of surface
      water, limiting recharge potential (<bold>CITATION NEEDED</bold>)
      and regions of high drainage density have been frequently
      associated with less permiable soils (<bold>CITATION
      NEEDED</bold>).</p>
      <p>Drainage density was calculated using the USGS National
      Hydrography Dataset (NHD) flowline features (<bold>Data
      Citation</bold>). This dataset consisted of both natural and
      engineered flowlines, including such things as underground pipes.
      Line density was calculated in Km of flowline per Km², using a
      search kernel of 1 Km.</p>
      <fig id="fig-drain">
        <caption><p>Figure 4: San Pedro drainage density. Line density
        calculated using a 1 Km search kernel.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="images/SanPedro_DrainDense.png" />
      </fig>
    </sec>
  </sec>
</sec>
<sec id="conclusion">
  <title>3 Conclusion</title>
</sec>
</body>

<back>
<ref-list>
  <title>References</title>
  <ref id="ref-aloui2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Aloui</surname><given-names>Sarra</given-names></name>
        <name><surname>Zghibi</surname><given-names>Adel</given-names></name>
        <name><surname>Mazzoni</surname><given-names>Annamaria</given-names></name>
        <name><surname>Elomri</surname><given-names>Adel</given-names></name>
        <name><surname>Al-Ansari</surname><given-names>Tareq</given-names></name>
      </person-group>
      <article-title>Identifying suitable zones for integrated aquifer recharge and flood control in arid qatar using GIS-based multi-criteria decision-making</article-title>
      <source>Groundwater for Sustainable Development</source>
      <year iso-8601-date="2024-05">2024</year><month>05</month>
      <volume>25</volume>
      <issn>2352-801X</issn>
      <pub-id pub-id-type="doi">10.1016/j.gsd.2024.101137</pub-id>
      <fpage>101137</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

<sub-article article-type="notebook" id="nb-4-nb-1">
<front-stub>
<title-group>
<article-title>Data Screening</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Purves</surname>
<given-names>Steve</given-names>
</name>
<string-name>Steve Purves</string-name>

</contrib>
<contrib contrib-type="author">
<name>
<surname>Wickham</surname>
<given-names>Charlotte</given-names>
</name>
<string-name>Charlotte Wickham</string-name>

<xref ref-type="author-note" rid="auth-note-2-nb-1">2</xref>
</contrib>
</contrib-group>
<author-notes>
<fn id="auth-note-2-nb-1" fn-type="author-note" symbol="2">Edited original
notebook by Steve Purves</fn>
</author-notes>
</front-stub>

<body>
<sec id="cell-25276572-nb-1" specific-use="notebook-content">
<preformat>import pandas as pd
import matplotlib.pyplot as plt</preformat>
</sec>
<sec id="cell-7f05db89-nb-1" specific-use="notebook-content">
<p>Import <monospace>la-palma.csv</monospace> - a clean subset of
<ext-link ext-link-type="uri" xlink:href="https://github.com/Notebooks-Now/submission-quarto-full/blob/main/data/catalogoComunSV_1663233588717.csv"><monospace>catalogoComunSV_1663233588717.csv</monospace></ext-link>:</p>
</sec>
<sec id="da2659e5-nb-1" specific-use="notebook-content">
<preformat>df = pd.read_csv('la-palma.csv')
df['DateTime'] = pd.to_datetime(df['DateTime'])
df = df.sort_values(by=['DateTime'], ascending=True)
df.head()</preformat>
<boxed-text>
  <table-wrap>
    <table border="1">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Longitude</th>
          <th>Latitude</th>
          <th>Depth(km)</th>
          <th>Magnitude</th>
          <th>DateTime</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>11346</td>
          <td>-17.8349</td>
          <td>28.5346</td>
          <td>26.0</td>
          <td>1.6</td>
          <td>2017-03-09 23:44:06+00:00</td>
        </tr>
        <tr>
          <td>11343</td>
          <td>-17.8459</td>
          <td>28.5491</td>
          <td>27.0</td>
          <td>2.0</td>
          <td>2017-03-10 00:16:10+00:00</td>
        </tr>
        <tr>
          <td>11344</td>
          <td>-17.8863</td>
          <td>28.5008</td>
          <td>20.0</td>
          <td>2.1</td>
          <td>2017-03-10 00:16:11+00:00</td>
        </tr>
        <tr>
          <td>11345</td>
          <td>-17.8657</td>
          <td>28.5204</td>
          <td>30.0</td>
          <td>1.6</td>
          <td>2017-03-10 03:20:26+00:00</td>
        </tr>
        <tr>
          <td>11342</td>
          <td>-17.7156</td>
          <td>28.5985</td>
          <td>0.0</td>
          <td>1.6</td>
          <td>2017-08-21 02:06:55+00:00</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</boxed-text>
</sec>
<sec id="ae1253df-nb-1" specific-use="notebook-content">
<preformat>df.describe()</preformat>
<boxed-text>
  <table-wrap>
    <table border="1">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Longitude</th>
          <th>Latitude</th>
          <th>Depth(km)</th>
          <th>Magnitude</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>count</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
        </tr>
        <tr>
          <td>mean</td>
          <td>-17.844062</td>
          <td>28.568893</td>
          <td>14.089345</td>
          <td>2.432423</td>
        </tr>
        <tr>
          <td>std</td>
          <td>0.027345</td>
          <td>0.021899</td>
          <td>8.624787</td>
          <td>0.705282</td>
        </tr>
        <tr>
          <td>min</td>
          <td>-17.995800</td>
          <td>28.310200</td>
          <td>0.000000</td>
          <td>0.200000</td>
        </tr>
        <tr>
          <td>25%</td>
          <td>-17.854100</td>
          <td>28.558000</td>
          <td>10.100000</td>
          <td>1.900000</td>
        </tr>
        <tr>
          <td>50%</td>
          <td>-17.838700</td>
          <td>28.564000</td>
          <td>11.300000</td>
          <td>2.600000</td>
        </tr>
        <tr>
          <td>75%</td>
          <td>-17.829700</td>
          <td>28.574300</td>
          <td>13.900000</td>
          <td>2.900000</td>
        </tr>
        <tr>
          <td>max</td>
          <td>-17.705700</td>
          <td>28.697800</td>
          <td>46.900000</td>
          <td>5.100000</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</boxed-text>
</sec>
<sec id="cell-81b4dfb2-nb-1" specific-use="notebook-content">
<preformat>df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, figsize=(12,12), grid=&quot;on&quot;);</preformat>
<boxed-text>
  <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-5-output-1.png" />
</boxed-text>
</sec>
<sec id="cell-19a1ba0d-nb-1" specific-use="notebook-content">
<sec id="filter-nb-1">
  <title>Filter</title>
  <p>Also some rows seem to be missing depth measurements, (see
  differences in the <bold>count</bold> for columns above) - take only
  rows with valid depths</p>
  </sec>
  <sec id="e56a69b3-nb-1" specific-use="notebook-content">
  <preformat>df = df[df['Depth(km)'].notna()]
df.describe()</preformat>
  <boxed-text>
    <table-wrap>
      <table border="1">
        <thead>
          <tr style="text-align: right;">
            <th></th>
            <th>Longitude</th>
            <th>Latitude</th>
            <th>Depth(km)</th>
            <th>Magnitude</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>count</td>
            <td>11347.000000</td>
            <td>11347.000000</td>
            <td>11347.000000</td>
            <td>11347.000000</td>
          </tr>
          <tr>
            <td>mean</td>
            <td>-17.844062</td>
            <td>28.568893</td>
            <td>14.089345</td>
            <td>2.432423</td>
          </tr>
          <tr>
            <td>std</td>
            <td>0.027345</td>
            <td>0.021899</td>
            <td>8.624787</td>
            <td>0.705282</td>
          </tr>
          <tr>
            <td>min</td>
            <td>-17.995800</td>
            <td>28.310200</td>
            <td>0.000000</td>
            <td>0.200000</td>
          </tr>
          <tr>
            <td>25%</td>
            <td>-17.854100</td>
            <td>28.558000</td>
            <td>10.100000</td>
            <td>1.900000</td>
          </tr>
          <tr>
            <td>50%</td>
            <td>-17.838700</td>
            <td>28.564000</td>
            <td>11.300000</td>
            <td>2.600000</td>
          </tr>
          <tr>
            <td>75%</td>
            <td>-17.829700</td>
            <td>28.574300</td>
            <td>13.900000</td>
            <td>2.900000</td>
          </tr>
          <tr>
            <td>max</td>
            <td>-17.705700</td>
            <td>28.697800</td>
            <td>46.900000</td>
            <td>5.100000</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </boxed-text>
  </sec>
  <sec id="cell-1368822d-nb-1" specific-use="notebook-content">
  <preformat>plt.figure(figsize=(20,6))
plt.subplot(1,3,1)
df[&quot;Latitude&quot;].plot.hist(bins=20, density=True)
plt.subplot(1,3,2)
df[&quot;Longitude&quot;].plot.hist(bins=20, density=True)
plt.subplot(1,3,3)
df[&quot;Depth(km)&quot;].plot.hist(bins=50, density=True)</preformat>
  <boxed-text>
    <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-7-output-1.png" />
  </boxed-text>
  </sec>
  <sec id="da7ad095-nb-1" specific-use="notebook-content">
</sec>
<sec id="spatial-plot-nb-1">
  <title>Spatial Plot</title>
  <p>Scatter plot the spatial locations of events</p>
  </sec>
  <sec id="cell-fig-spatial-plot-nb-1" specific-use="notebook-content">
  <preformat>#| label: fig-spatial-plot
#| fig-cap: Locations of earthquakes on La Palma since 2017.
#| fig-alt: A scatterplot of earthquake locations plotting latitude against longitude.
from matplotlib import colormaps
cmap = colormaps['viridis_r']
ax = df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, 
                     s=47-df[&quot;Depth(km)&quot;], c=df[&quot;Magnitude&quot;], 
                     figsize=(12,10), grid=&quot;on&quot;, cmap=cmap)
colorbar = ax.collections[0].colorbar
colorbar.set_label(&quot;Magnitude&quot;)

plt.show()</preformat>
  <boxed-text>
    <fig id="fig-spatial-plot-nb-1">
      <caption><p>Locations of earthquakes on La Palma since
      2017.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/fig-spatial-plot-output-1.png" />
    </fig>
  </boxed-text>
  </sec>
  <sec id="cell-22ac5ce7-nb-1" specific-use="notebook-content">
  <sec id="timeline-plot-nb-1">
    <title>Timeline Plot</title>
    <p>Scatter plot the event time series and look for any quantization
    issues. Have times &amp; dates been loaded correctly?</p>
    <p>ax = df.plot.scatter(x=‘DateTime’, y=‘Depth(km)’, figsize=(20,8))
    ax.set_ylim(50,0);</p>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>

</article>